<div class="pesto-page pesto-recipe-page">
  <div class="pesto-recipe-background-image"
       ng-animate-ref="{{'recipe' + detail.recipeId}}"
       ng-style="{'background-image': 'url(' + detail.recipe.imageUrl + ')'}">
  </div>

  <div class="pesto-recipe-layout">
    <div class="pesto-recipe-header">
      <md-button ng-if="!detail.isEditing()" class="pesto-recipe-back md-icon-button" aria-label="Close"
                 ng-click="detail.goBack()">
        <md-icon md-svg-icon="assets/pesto-arrow-back.svg"></md-icon>
      </md-button>
      <md-menu ng-if="!detail.isEditing()" class="pesto-recipe-more">
        <md-button class="md-icon-button" ng-click="$mdOpenMenu($event)" aria-label="More menu">
          <md-icon md-svg-icon="assets/pesto-more-vert.svg"></md-icon>
        </md-button>
        <md-menu-content>
          <md-menu-item>
            <md-button ng=click="">Item 1</md-button>
          </md-menu-item>
          <md-menu-item>
            <md-button ng=click="">Item 2</md-button>
          </md-menu-item>
        </md-menu-content>
      </md-menu>

      <md-button ng-if="detail.isEditing()" class="pesto-recipe-cancel md-icon-button" aria-label="Cancel"
                 ng-click="detail.cancelChanges()">
        <md-icon md-svg-icon="assets/pesto-cancel.svg"></md-icon>
      </md-button>
      <md-button ng-if="detail.isEditing()" class="pesto-recipe-save md-icon-button" aria-label="More"
                 ng-click="detail.saveChanges()">
        <md-icon md-svg-icon="assets/pesto-check.svg"></md-icon>
      </md-button>
    </div>
    
    <div class="pesto-recipe-content">
      <!-- <span class="anchortest" ng-animate-ref="test1">Hello</span> -->
      <div class="pesto-recipe-table">
      
        <div class="pesto-recipe-row">
          <div class="pesto-recipe-col"></div>
          <div class="pesto-recipe-col pesto-recipe-name">
            <span ng-if="!detail.isEditing()">{{detail.recipe.name}}</span>
            <md-input-container ng-if="detail.isEditing()">
              <label>Recipe name</label>
              <input type="text" ng-model="detail.recipe.name">
            </md-input-container>
          </div>
        </div>

        <div class="pesto-recipe-row">
          <div class="pesto-recipe-col"></div>
          <div class="pesto-recipe-col pesto-recipe-description">
            <span ng-if="!detail.isEditing()">{{detail.recipe.description}}</span>
            <md-input-container ng-if="detail.isEditing()">
              <label>Recipe description</label>
              <textarea type="text" ng-model="detail.recipe.description" placeholder=""></textarea>
            </md-input-container>            
          </div>
        </div>

        <div class="pesto-recipe-row" ng-if="detail.isEditing()">
          <div class="pesto-recipe-col"></div>
          <div class="pesto-recipe-col">
            <md-input-container ng-if="detail.isEditing()">
              <label>Image URL</label>
              <input type="text" ng-model="detail.newImageUrl" ng-blur="detail.updateImageUrl()">
            </md-input-container>
          </div>
        </div>

        <div class="pesto-recipe-row">
          <div class="pesto-recipe-col"></div>
          <div class="pesto-recipe-col pesto-section-description">Ingredients</div>
        </div>
        <div class="pesto-recipe-row" ng-if="!detail.isEditing()" ng-repeat="ingredient in detail.recipe.ingredients">
          <div class="pesto-recipe-col pesto-ingredient-amount">{{ingredient.amount}}</div>
          <div class="pesto-recipe-col pesto-ingredient-description">{{ingredient.description}}</div>
        </div>
        <div class="pesto-recipe-row" ng-if="detail.isEditing()" ng-repeat="ingredient in detail.recipe.ingredients">
          <div class="pesto-recipe-col pesto-ingredient-amount">
            <md-input-container>
              <label>Amount</label>
              <input type="text" size="6" ng-model="ingredient.amount">
            </md-input-container>
          </div>
          <div class="pesto-recipe-col pesto-ingredient-description">
            <md-input-container>
              <label>Description</label>
              <input type="text" ng-model="ingredient.description">
            </md-input-container>
          </div>
        </div>
        <div class="pesto-recipe-row" ng-if="detail.isEditing()">
          <div class="pesto-recipe-col"></div>
          <div class="pesto-recipe-col">
            <md-button ng-click="detail.addIngredient()">+Ingredient</md-button>
          </div>
        </div>

        <div class="pesto-recipe-row">
          <div class="pesto-recipe-col"></div>
          <div class="pesto-recipe-col pesto-section-description">Steps</div>
        </div>
        <div class="pesto-recipe-row" ng-if="!detail.isEditing()" ng-repeat="step in detail.recipe.steps">
          <div class="pesto-recipe-col pesto-step-duration">{{step.duration}}</div>
          <div class="pesto-recipe-col pesto-step-description">{{step.description}}</div>
        </div>
        <div class="pesto-recipe-row" ng-if="detail.isEditing()" ng-repeat="step in detail.recipe.steps">
          <div class="pesto-recipe-col pesto-step-duration">
            <md-input-container>
              <label>Time</label>
              <input type="text" size="6" ng-model="step.duration">
            </md-input-container>
          </div>
          <div class="pesto-recipe-col pesto-step-description">
            <md-input-container>
              <label>Description</label>
              <input type="text" ng-model="step.description">
            </md-input-container>
          </div>
        </div>
        <div class="pesto-recipe-row" ng-if="detail.isEditing()">
          <div class="pesto-recipe-col"></div>
          <div class="pesto-recipe-col">
            <md-button ng-click="detail.addStep()">+Step</md-button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Floating action button, should this change position for desktop/mobile? -->
  <md-button ng-if="!detail.isEditing()"
             class="md-fab pesto-edit-button"
             aria-label="New Recipe"
             ng-click="detail.editRecipe()">
    <md-icon md-svg-src="assets/pesto-edit.svg"></md-icon>
  </md-button>

</div>
